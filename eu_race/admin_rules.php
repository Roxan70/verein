<?php
require_once __DIR__ . '/inc/header.php'; require_login(); require_role('admin');
if($_SERVER['REQUEST_METHOD']==='POST'){$scope=$_POST['scope'];$type=$_POST['type_code'];$langr=$_POST['lang'];$title=trim($_POST['title']);$url=trim($_POST['url']);$sum=trim($_POST['summary']);$st=$mysqli->prepare('INSERT INTO rule_sources (scope,type_code,lang,title,url,summary) VALUES (?,?,?,?,?,?)');$st->bind_param('ssssss',$scope,$type,$langr,$title,$url,$sum);$st->execute();$st->close();}
$page=get_page();$off=get_offset($page,PAGE_SIZE);$st=$mysqli->prepare('SELECT rule_id,scope,type_code,lang,title,url FROM rule_sources ORDER BY updated_at DESC LIMIT ? OFFSET ?');$st->bind_param('ii',$ps=PAGE_SIZE,$off);$st->execute();$st->bind_result($id,$scope,$type,$langr,$title,$url);
?><div class="card"><form method="post" class="row"><div class="col"><select name="scope"><option>FCI</option><option>AT</option><option>DE</option><option>HU</option><option>CZ</option><option>SK</option><option>OTHER</option></select></div><div class="col"><select name="type_code"><option>ALL</option><option>TRACK</option><option>COURSING</option><option>FUNRUN</option></select></div><div class="col"><select name="lang"><option>de</option><option>en</option><option>hu</option><option>cs</option><option>sk</option></select></div><div class="col"><input name="title" required></div><div class="col"><input name="url"></div><div class="col"><textarea name="summary"></textarea></div><div class="col"><button>Save</button></div></form></div><table><tr><th>ID</th><th>Scope</th><th>Type</th><th>Lang</th><th>Title</th><th>URL</th></tr><?php while($st->fetch()):?><tr><td><?php echo(int)$id;?></td><td><?php echo e($scope);?></td><td><?php echo e($type);?></td><td><?php echo e($langr);?></td><td><?php echo e($title);?></td><td><?php echo e($url);?></td></tr><?php endwhile;?></table><?php $st->close(); require_once __DIR__ . '/inc/footer.php'; ?>
